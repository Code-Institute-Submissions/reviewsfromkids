{% extends "base.html" %}
{% load static %}

{% block page_header %}
{% endblock %}

{% block hero %} 
{% endblock %}

{% block content %}
  <main>
    <div class="book-details">
      <h2 class="book-details__title">{{ book.title }}</h2>
      <div class="book-details__image-container">
        <img class="card-img-top img-fluid" src="{{ book.image.url }}" alt="{{ book.name }}">
      </div>
      <div class="book-details__quick-facts">
        <div class="book-details__quick-facts__age">
          <small>Recommended age:</small> <br>{{ book.age }} yrs
        </div>
        <div class="book-details__quick-facts__ratings">
          {% if book.rating_all %}
          Rating all: <small class="text-muted"><i class="fas fa-star mr-1"></i>{{ book.rating_all }} / 5</small>
          Rating girls: <small class="text-muted"><i class="fas fa-star mr-1"></i>{{ book.rating_girls }} / 5</small>
          Rating boys: <small class="text-muted"><i class="fas fa-star mr-1"></i>{{ book.rating_boys }} / 5</small>
      {% else %}
          <small class="text-muted">No Rating</small>
      {% endif %}
        </div>
      </div>
      <div class="book-details__section">
        <h4>This book is about</h4>
        {{ book.description }}
        <br>
        Category: <span class="badge badge-primary">{{ book.category }}</span>
        <div>
        Tags:  {% for tag in book.tags.all %}
            <span class="badge badge-info">{{ tag }}</span>
          {% endfor %}
        </div>
      </div>
      <div class="book-details__section">
        <h4>Reviews & Ratings</h4>
        <a href="#">Rate this book</a>
        {% for i in rating %}
        {{ i.rated_by.gender }}
        {{ i.rated_by.date_of_birth }}
        {{ i.rating }}
        {{ i.sports }}
        {{ i.hobbies }}
        {% endfor %}

        Rating by all: {{ avg_rating }}
        Rating by boys: {{ boys_avg_rating }}
        Rating by girls: {{ girls_avg_rating }}
      </div>

      <div>
        <form method="POST" action="{% url 'profile' %}">
          {% csrf_token %}
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio1" value="1">
            <label class="form-check-label" for="inlineRadio1">1</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio2" value="2">
            <label class="form-check-label" for="inlineRadio2">2</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio3" value="3">
            <label class="form-check-label" for="inlineRadio3">3</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio4" value="4">
            <label class="form-check-label" for="inlineRadio4">4</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio5" value="5">
            <label class="form-check-label" for="inlineRadio5">5</label>
          </div>
        </form>
      </div>

      <div class="book-details__section">
        <h4>Book info</h4>
        <p class="mt-3">ISBN: {{ book.isbn }}</p>
        <p class="mt-3">Pages: {{ book.pages }}</p>
        <p class="mt-3">Age from {{ book.age }}</p>
        <p class="mt-3">Best suited for {% if book.gender == "all" %} girls and boys.                  
          {% else %}
          {{ book.gender }} {% endif %}</p>
        <p class="mt-3">Author: {{ book.author }}</p>
      </div>
    </div>
  </main>
{% endblock %}
{% block postloadjs %}
<script>
$(function () {
  $('input[name="ratingOptions"]').on('change',function(){
    $('form').submit();
    console.log('rating selected');
  });
});
</script>
{% endblock %}