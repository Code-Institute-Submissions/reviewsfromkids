{% load i18n %}
{% autoescape off %}
{% blocktrans %}Please Confirm Your E-mail Address{% endblocktrans %}
{% endautoescape %}





rgb(118, 118, 118), rgb(195, 195, 195))

{% if profile.first_name %}{{ profile.first_name }}{% endif %}

profile-modal__personal--edit



Can access attributes of profile via rating! However, cannot get to hobbies and sports. Probably, because these are linked to profile via manytomany. Need to find out.

{% for i in rating %}
        {{ i.rated_by.gender }}
        {{ i.rated_by.date_of_birth }}
        {{ i.rating }}
        {{ i.sports }}
        {{ i.hobbies }}
        {% endfor %}


        stripe.Customer.create(email=request.POST['email'],
        name=request.POST['name'],
        )

        Test2
        {% if not user_hobby and not user_sport %}
        <p>Your profile does not contain hobbies or sports. No problemo. You get better recommendations if you tell more about yourself.</p>
        {% else %}
           {% if not user_hobby %}
             <p>Your profile does not contain hobbies. No problemo. You get better recommendations if you tell more about yourself.</p>
           {% endif %}
           {% if not user_sport %}
             <p>Your profile does not contain sports. No problemo. You get better recommendations if you tell more about yourself.</p>
           {% endif %}
        {% endif %}
        {% if user_hobby and user_sport %}
         <a href="" class="btn">next cat</a>
        {% else %}
         <a href="" class="btn">next hobspor</a>
        {% endif %}
        
   
         Check bools:
       <li>hobbysport_available = {{ hobbysport_available }}</li>
       <li>onlyhobby_available = {{ onlyhobby_available }}</li>
       <li>onlysport_available = {{ onlysport_available }}</li>
       <li>no_hobbysport_available = {{ no_hobbysport_available }}</li>

       
       'hobbysport_available': hobbysport_available,
        'onlyhobby_available': onlyhobby_available,
        'onlysport_available': onlysport_available,
        'no_hobbysport_available': no_hobbysport_available,


# Set bools needed for bookfinder functionality
if profile.sports.all().exists()==True:
    profile.sports_known = True
else:
    profile.sports_known = False

if profile.hobbies.all().exists()==True:
    profile.hobbies_known = True
else:
    profile.hobbies_known = False

if profile.hobbies_known == True and profile.sports_known == True:
    profile.hobbies_and_sports_known = True
else:
    profile.hobbies_and_sports_known = False

if profile.hobbies_known == True and profile.sports_known == False:
    profile.only_hobbies_known = True
else:
    profile.only_hobbies_known = False

if profile.hobbies_known == False and profile.sports_known == True:
    profile.only_sports_known = True
else:
    profile.only_sports_known = False

if profile.hobbies_known == False and profile.sports_known == False:
    profile.no_hobbies_and_sports_known = True
else:
    profile.no_hobbies_and_sports_known = False

profile.save()


Op basis van hobby:

a = Rating.objects.filter(hobbies__name='lego')
# print(a.values())

b = a.filter(rating__gte=4, age_rating_years=age_rating_years, gender=profile.gender)
c = b.values('book_id_id')
recommended_by_age_gender = Book.objects.filter(pk__in=c)
print(recommended_by_age_gender)



Goeie manier om overeenkomsten te vinden:
# Find books that match users' hobbies
    # all_hobbies_of_positive_ratings = Hobby.objects.filter(rating__book_id=book_id, rating__rating__gte=4)
    # hobbies_positive_ratings = all_hobbies_of_positive_ratings.values('name').annotate(Count('name')).order_by('-name__count')[:2]

    # <QuerySet [{'name': 'dancing', 'name__count': 1}, {'name': 'lego', 'name__count': 1}]>
    # testset1 = Book.objects.filter(pk__in=book_ids)
    # testset2 = Book.objects.filter(pk__in=book_ids)
    
    # print(testset1)
    # print(testset2)
    # testset1_names = testset1.values_list('author')
    # testset2_names = testset2.values_list('author')
    # print(testset1_names)
    # print(type(testset1_names))
    # # testset1_names = testset2.values_list('name')
    # key1 = frozenset(testset1_names)
    # key2 = frozenset(testset2_names)
 
    # common_items = frozenset.intersection(key1, key2)
    # print(common_items)

Oude code voor bookfinder:
# ratings_high = Rating.objects.filter(rating__gte=4, age_rating_years=age_rating_years, gender=profile.gender)

    # Find book objects for the high rates that match users' age and gender
    # book_ids = ratings_high.values('book_id_id')
    # recommended_by_age_gender = Book.objects.filter(pk__in=book_ids)
    
    # print('recommended_by_age_gender:', recommended_by_age_gender)
    # print(type(recommended_by_age_gender))
    
    # all_hobbies_of_positive_ratings = Hobby.objects.filter(rating__age_rating_years=age_rating_years, rating__rating__gte=4)
    # print(all_hobbies_of_positive_ratings.values())





    <div class="refine-sort">
        <div class="refine-sort__message">
            {% if searched_term == None %}
                There are xxx books waiting for you!
                <form class="strip-margin" method="GET" action="{% url 'books' %}">
                    <div class="search__box">
                      <input class="search__box--input" type="text" name="q" placeholder="    search title, author, theme, tag">
                      <button class="btnize search__icon" type="submit">
                        <i class="fas fa-search"></i>
                      </button>
                    </div>
                  </form>
                {% else %}
                Your search for {{ searched_term }} has 
                {% if numResults == 1 %}
                    {{ numResults }} search result.
                {% elif numResults > 1 %}
                    {{ numResults }} search results.
                {% else %}
                    no results, please try again.
                {% endif %}
            {% endif %}
        </div>
    </div>


Oude search code:
# if request.GET:
#     if 'q' in request.GET:
#         query = request.GET['q']
#         if not query:
#             messages.error(request, "You didn't enter any search criteria!")
#             return redirect (reverse('books'))
        
#         queries =  Q(tags__name__icontains=query) | Q(title__icontains=query) | Q(description__icontains=query) | Q(category__name__icontains=query) | Q(author__icontains=query)| Q(gender__icontains=query) | Q(age__icontains=query)
#         books = books.filter(queries).distinct()
#         search_results = True
#         searched_term=request.GET['q']

#         # check what query was hit
#         if books.filter(Q(title__icontains=query)):
#             title_hit = searched_term
#             print(title_hit)

#         if books.filter(Q(description__icontains=query)):
#             description_hit = searched_term
#             print(description_hit)

# initiated from search in menu

# Delete rating
if request.POST.get('type_of_action')=='delete':

            current_user_rating.delete()
            
            messages.warning(request, f'Rating deleted')


# testing
<div class="test-grid">
  <h4 class="key">Book</h4>
  <p class="key">age_on_book</p><p class="value">{{ book.age_on_book }}</p>
  <p class="key">rating</p><p class="value">{{ book.rating }}</p>
  <p class="key">number_of_ratings</p><p class="value">{{ book.number_of_ratings }}</p>
  <p class="key">boys_avg_rating</p><p class="value">{{ book.boys_avg_rating }}</p>
  <p class="key">boys_number_of_ratings</p><p class="value">{{ book.boys_number_of_ratings }}</p>
  <p class="key">girls_avg_rating</p><p class="value">{{ book.girls_avg_rating }}</p>
  <p class="key">girls_number_of_ratings</p><p class="value">{{ book.girls_number_of_ratings }}</p>
  <p class="key">most_liked_by</p><p class="value">{{ book.most_liked_by }}</p>
  <p class="key">most_disliked_by</p><p class="value">{{ book.most_disliked_by }}</p>
  <p class="key">recommended_age</p><p class="value">{{ book.recommended_age }}</p>
  <p class="key">not_recommended_by_age</p><p class="value">{{ book.not_recommended_by_age }}</p>
  <p class="key">not_recommended_by_age_girls</p><p class="value">{{ not_recommended_by_age_girls }}</p>
  <p class="key">not_recommended_by_age_boys</p><p class="value">{{ not_recommended_by_age_boys }}</p>
</div>
<div class="test-grid">
  <h4 class="key">Rating</h4>
  <p class="key">current_user_rating</p><p class="value">{{ current_user_rating }}</p>
  <p class="key">already_rated</p><p class="value">{{ already_rated }}</p>
  <p class="key">hobbies_positive_ratings</p><p class="value">{{ hobbies_positive_ratings }}</p>
  <p class="key">hobbies_negative_ratings</p><p class="value">{{ hobbies_negative_ratings }}</p>
</div>

# Rating radio buttons - new
<div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio1" value="1">
    <label class="form-check-label" for="inlineRadio1">1</label>
  </div>
  <div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio2" value="2">
    <label class="form-check-label" for="inlineRadio2">2</label>
  </div>
  <div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio3" value="3">
    <label class="form-check-label" for="inlineRadio3">3</label>
  </div>
  <div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio4" value="4">
    <label class="form-check-label" for="inlineRadio4">4</label>
  </div>
  <div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio5" value="5">
    <label class="form-check-label" for="inlineRadio5">5</label>
  </div>

  # Rating radio buttons - profile-modal__personal--edit<div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio1" value="1" {% if current_user_rating.rating == 1 %}checked{% endif %}>
    <label class="form-check-label" for="inlineRadio1">1</label>
  </div>
  <div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio2" value="2" {% if current_user_rating.rating == 2 %}checked{% endif %}>
    <label class="form-check-label" for="inlineRadio2">2</label>
  </div>
  <div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio3" value="3" {% if current_user_rating.rating == 3 %}checked{% endif %}> 
    <label class="form-check-label" for="inlineRadio3">3</label>
  </div>
  <div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio4" value="4" {% if current_user_rating.rating == 4 %}checked{% endif %}>
    <label class="form-check-label" for="inlineRadio4">4</label>
  </div>
  <div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" name="ratingOptions" id="inlineRadio5" value="5" {% if current_user_rating.rating == 5 %}checked{% endif %}>
    <label class="form-check-label" for="inlineRadio5">5</label>
  </div>



  // Nice system

  <fieldset class="rating">
    <input type="radio" id="star5" name="rating" {% if current_user_rating.rating == 5 %}checked{% endif %}/><label class = "full" for="star5"></label>
    <input type="radio" id="star4half" name="rating" {% if current_user_rating.rating == 4.5 %}checked{% endif %}/><label class="half" for="star4half"></label>
    <input type="radio" id="star4" name="rating" {% if current_user_rating.rating == 4 %}checked{% endif %}/><label class = "full" for="star4"></label>
    <input type="radio" id="star3half" name="rating" {% if current_user_rating.rating == 3.5 %}checked{% endif %}/><label class="half" for="star3half"></label>
    <input type="radio" id="star3" name="rating" {% if current_user_rating.rating == 3 %}checked{% endif %}/><label class = "full" for="star3">
    <input type="radio" id="star2half" name="rating" {% if current_user_rating.rating == 2.5 %}checked{% endif %}/><label class="half" for="star2half"></label>
    <input type="radio" id="star2" name="rating" {% if current_user_rating.rating == 2 %}checked{% endif %}/><label class = "full" for="star2"></label>
    <input type="radio" id="star1half" name="rating" {% if current_user_rating.rating == 1.5 %}checked{% endif %}/><label class="half" for="star1half"></label>
    <input type="radio" id="star1" name="rating" {% if current_user_rating.rating == 0.5 %}checked{% endif %}/><label class = "full" for="star1"></label>
    <input type="radio" id="starhalf" name="rating" {% if current_user_rating.rating == 0 %}checked{% endif %}/><label class="half" for="starhalf"></label>
    
</fieldset>

